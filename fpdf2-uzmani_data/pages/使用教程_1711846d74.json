{
  "url": "https://py-pdf.github.io/fpdf2/Tutorial-zh.html",
  "title": "使用教程¶",
  "content": "完整说明文件： fpdf.FPDF API 文档\n\n引入库文件后，创建FPDF对象。 FPDF 构造函数在此使用默认值：页面 A4 纵向；单位毫米。 当然，这可以被明确定义：\n\n同时，也可以将 PDF 设置为横向模式 (L) 或使用其他页面格式 （如 Letter 和 Legal）和度量单位（pt、cm、in）。\n\n到此，文件暂无页面。调用 add_page 添加页面，原点位于页面左上角，当前位置默认为距边界 1 厘米处。 边距也可以调用 set_margins 更改。\n\n在加入文本之前，必须选定字体 set_font ，否则文件无效。 选择字体 Helvetica，粗体，16号：\n\n使用 I 指定斜体，U 加下划线或空字符串指定常规字体。 请注意，字号单位是点数，而非毫米（或其他指定的单位）。 这是单位设置的唯一例外。其他内置字体有 Times、Courier、Symbol 与 ZapfDingbats。\n\n调用 cell 创建一个单元格。单元格是一个矩形区域，可能带有外框， 其中包含一些文本，且置于当前位置。 单元格的尺寸，排版（居中或对齐），是否有边框 ，以及所放置的位置（向右，向下或换行）可配置的。 添加一个框架：\n\n备注：换行也可调用 ln 实现。此方法允许指定换行行距。\n\n最终，关闭文件并保存于给定路径 output。 无参数时，output()返回 PDF bytearray 缓冲区。\n\n此教程使用了下述包含页眉、页脚和徽标的示例：\n\n此示例使用 header 与 footer 处理页眉和页脚。 虽然二者属于 FPDF 类，被自动调用，但默认是空置的， 因此需要扩展类从而覆盖缺省值。\n\n调用 image 依照指定的起始坐标（左上角）与宽度添加图标。 高度将依照图像比例自动计算。\n\n可将空值作为单元格宽度以打印页码。这使单元格延伸到页面的右边缘， 便于文本居中。当前页码由 page_no 返回。至于总页数，可以通过值{nb}获得。 {nb}将在文档关闭时被替换（此值调用 alias_nb_pages() 更改)。注意，调用 set_y 能够从顶部或底部起，设置在页面中的绝对位置。\n\n示例中使用了另一个有趣的特性：自动分页。 一旦单元格会越过页面中的限制（默认距离底部 2 厘米处）， 将执行中断并恢复字体设置。 虽然标题和页脚仍然使用自身的字体（helvetica），但正文将继续使用 Times 字体。 这种自动恢复机制同样适用于字体颜色与行距。 触发分页符的机制可以通过 set_auto_page_break 配置。\n\n让我们继续上述对齐段落的示例。此教程也将演示颜色的配置方法。\n\n调用 get_string_width 函数设定当前字体下字符串的长度， 从而计算当前位置标题外框的宽度。 通过 set_draw_color、 set_fill_color和 set_text_color 设置颜色。行距由 set_line_width 设定为 1 mm（默认为 0.2）。 最终，输出单元格（末位参数 true 表示必须填充背景）。\n\n调用multi_cell 函数打印段落（文本默认对齐）。 每当到达单元格的右端或遇到回车符 (\\n) 时， 换行并在当前单元格下自动创建一个新的单元格。 自动换行在右起最近的空格或软连字符 (\\u00ad) 触发。 当触发换行符时，软连字符将被普通连字符替换，否则将被忽略。\n\n示例中设定了两个文档属性：标题 (set_title) 与作者 (set_author)。 文档的属性可以直接用 Acrobat 阅读器 打开， 在文件菜单中选择文档属性查看； 也可以使用插件，右击并选择 文档属性 查看。\n\n此示例是上一个示例的变体，展示了如何将文本放置在多个栏目中。\n\n此版本与先例的重点区别于使用了text_columns。此函数用于（逐段）收集文本并把其放置于多个栏目中，自主按需插入换页符。需注意，虽(TextColumns)实例会起到上下文管理器的作用，但文本样式与其他字体属性依旧可被更改。此类变更仅会被使用与当前的执行环境中，若退出执行环境则会恢复原定设置。\n\n本教程将演示如何创建两份不同的表格，以此展示简单改动参数可带来的效果。\n\n案例一最为基础，仅使用了FPDF.table()来快速生成一张基础表格。\n\n案例二在此基础上进行了色彩、表格限宽、缩减文本高度、标题居中、自定义项目栏宽度、右对齐数据等方面的改良。并选用了TableBordersLayout中合适的(borders_layout)参数来去除下边框。\n\n本教程将演示几种在 pdf 文档中插入内部链接，或指向外部资源 的超链接的方法，以及几种在同一文本中使用不同文本样式 （粗体、斜体、下划线）的方法。\n\n此处显示的打印文本的新方法是 write() ，类似于 multi_cell() 。二者主要区别在于：\n\n因此，该方法允许在一段文本中更改字体样式，并从初始位置继续。 反之，它的缺点在于其不能如同 multi_cell() 对齐文本。\n\n因为上述原因，在示例的第一页中，调用了 write() 打印常规字体，然后使用 set_font() 方法，切换到下划线样式并继续打印。\n\n为添加指向第二页的内部链接，调用了 add_link() 。这将创建一个可点击区域，命名为“链接”，指向 文档中的另一页。\n\n使用图像创建外部链接，则调用 image() 。该函数可将链接作为其参数之一。链接也可以指向内部或外部。\n\n作为替代方案，更改字体样式和添加链接的另一种选择是 使用 write_html() 方法。这是一个 html 解析器， 允许添加文本，更改字体样式并添加链接。",
  "headings": [
    {
      "level": "h1",
      "text": "使用教程¶",
      "id": "_1"
    },
    {
      "level": "h2",
      "text": "教程一 - 简单的示例¶",
      "id": "-"
    },
    {
      "level": "h2",
      "text": "教程二 - 页眉、页脚、分页符与图像¶",
      "id": "-_1"
    },
    {
      "level": "h2",
      "text": "教程三 - 换行符和颜色¶",
      "id": "-_2"
    },
    {
      "level": "h2",
      "text": "教程四 - 多栏目¶",
      "id": "-_3"
    },
    {
      "level": "h2",
      "text": "教程五 - 创建表¶",
      "id": "-_4"
    },
    {
      "level": "h2",
      "text": "教程六 - 创建链接和混合文本样式¶",
      "id": "-_5"
    }
  ],
  "code_samples": [
    {
      "code": "from fpdf import FPDF\n\npdf = FPDF()\npdf.add_page()\npdf.set_font(\"helvetica\", style=\"B\", size=16)\npdf.cell(40, 10, \"Hello World!\")\npdf.output(\"tuto1.pdf\")",
      "language": "python"
    },
    {
      "code": "pdf = FPDF(orientation=\"P\", unit=\"mm\", format=\"A4\")",
      "language": "unknown"
    },
    {
      "code": "pdf.set_font('Helvetica', style='B', size=16)",
      "language": "unknown"
    },
    {
      "code": "pdf.cell(40, 10, 'Hello World!', 1)",
      "language": "unknown"
    },
    {
      "code": "pdf.cell(60, 10, 'Powered by FPDF.', new_x=\"LMARGIN\", new_y=\"NEXT\", align='C')",
      "language": "unknown"
    },
    {
      "code": "from fpdf import FPDF\n\n\nclass PDF(FPDF):\n    def header(self):\n        # Rendering logo:\n        self.image(\"../docs/fpdf2-logo.png\", 10, 8, 33)\n        # Setting font: helvetica bold 15\n        self.set_font(\"helvetica\", style=\"B\", size=15)\n        # Moving cursor to the right:\n        self.cell(80)\n        # Printing title:\n        self.cell(30, 10, \"Title\", border=1, align=\"C\")\n        # Performing a line break:\n        self.ln(20)\n\n    def footer(self):\n        # Position cursor at 1.5 cm from bottom:\n        self.set_y(-15)\n        # Setting font: helvetica italic 8\n        self.set_font(\"helvetica\", style=\"I\", size=8)\n        # Printing page number:\n        self.cell(0, 10, f\"Page {self.page_no()}/{{nb}}\", align=\"C\")\n\n\n# Instantiation of inherited class\npdf = PDF()\npdf.add_page()\npdf.set_font(\"Times\", size=12)\nfor i in range(1, 41):\n    pdf.cell(0, 10, f\"Printing line number {i}\", new_x=\"LMARGIN\", new_y=\"NEXT\")\npdf.output(\"new-tuto2.pdf\")",
      "language": "python"
    },
    {
      "code": "from fpdf import FPDF\n\n\nclass PDF(FPDF):\n    def header(self):\n        # Setting font: helvetica bold 15\n        self.set_font(\"helvetica\", style=\"B\", size=15)\n        # Calculating width of title and setting cursor position:\n        width = self.get_string_width(self.title) + 6\n        self.set_x((210 - width) / 2)\n        # Setting colors for frame, background and text:\n        self.set_draw_color(0, 80, 180)\n        self.set_fill_color(230, 230, 0)\n        self.set_text_color(220, 50, 50)\n        # Setting thickness of the frame (1 mm)\n        self.set_line_width(1)\n        # Printing title:\n        self.cell(\n            width,\n            9,\n            self.title,\n            border=1,\n            new_x=\"LMARGIN\",\n            new_y=\"NEXT\",\n            align=\"C\",\n            fill=True,\n        )\n        # Performing a line break:\n        self.ln(10)\n\n    def footer(self):\n        # Setting position at 1.5 cm from bottom:\n        self.set_y(-15)\n        # Setting font: helvetica italic 8\n        self.set_font(\"helvetica\", style=\"I\", size=8)\n        # Setting text color to gray:\n        self.set_text_color(128)\n        # Printing page number\n        self.cell(0, 10, f\"Page {self.page_no()}\", align=\"C\")\n\n    def chapter_title(self, num, label):\n        # Setting font: helvetica 12\n        self.set_font(\"helvetica\", size=12)\n        # Setting background color\n        self.set_fill_color(200, 220, 255)\n        # Printing chapter name:\n        self.cell(\n            0,\n            6,\n            f\"Chapter {num} : {label}\",\n            new_x=\"LMARGIN\",\n            new_y=\"NEXT\",\n            align=\"L\",\n            fill=True,\n        )\n        # Performing a line break:\n        self.ln(4)\n\n    def chapter_body(self, filepath):\n        # Reading text file:\n        with open(filepath, \"rb\") as fh:\n            txt = fh.read().decode(\"latin-1\")\n        # Setting font: Times 12\n        self.set_font(\"Times\", size=12)\n        # Printing justified text:\n        self.multi_cell(0, 5, txt)\n        # Performing a line break:\n        self.ln()\n        # Final mention in italics:\n        self.set_font(style=\"I\")\n        self.cell(0, 5, \"(end of excerpt)\")\n\n    def print_chapter(self, num, title, filepath):\n        self.add_page()\n        self.chapter_title(num, title)\n        self.chapter_body(filepath)\n\n\npdf = PDF()\npdf.set_title(\"20000 Leagues Under the Seas\")\npdf.set_author(\"Jules Verne\")\npdf.print_chapter(1, \"A RUNAWAY REEF\", \"20k_c1.txt\")\npdf.print_chapter(2, \"THE PROS AND CONS\", \"20k_c1.txt\")\npdf.output(\"tuto3.pdf\")",
      "language": "python"
    },
    {
      "code": "from fpdf import FPDF\n\n\nclass PDF(FPDF):\n    def header(self):\n        self.set_font(\"helvetica\", style=\"B\", size=15)\n        width = self.get_string_width(self.title) + 6\n        self.set_x((210 - width) / 2)\n        self.set_draw_color(0, 80, 180)\n        self.set_fill_color(230, 230, 0)\n        self.set_text_color(220, 50, 50)\n        self.set_line_width(1)\n        self.cell(\n            width,\n            9,\n            self.title,\n            border=1,\n            new_x=\"LMARGIN\",\n            new_y=\"NEXT\",\n            align=\"C\",\n            fill=True,\n        )\n        self.ln(10)\n\n    def footer(self):\n        self.set_y(-15)\n        self.set_font(\"helvetica\", style=\"I\", size=8)\n        self.set_text_color(128)\n        self.cell(0, 10, f\"Page {self.page_no()}\", align=\"C\")\n\n    def chapter_title(self, num, label):\n        self.set_font(\"helvetica\", size=12)\n        self.set_fill_color(200, 220, 255)\n        self.cell(\n            0,\n            6,\n            f\"Chapter {num} : {label}\",\n            new_x=\"LMARGIN\",\n            new_y=\"NEXT\",\n            border=\"L\",\n            fill=True,\n        )\n        self.ln(4)\n\n    def chapter_body(self, fname):\n        # Reading text file:\n        with open(fname, \"rb\") as fh:\n            txt = fh.read().decode(\"latin-1\")\n        with self.text_columns(\n            ncols=3, gutter=5, text_align=\"J\", line_height=1.19\n        ) as cols:\n            # Setting font: Times 12\n            self.set_font(\"Times\", size=12)\n            cols.write(txt)\n            cols.ln()\n            # Final mention in italics:\n            self.set_font(style=\"I\")\n            cols.write(\"(end of excerpt)\")\n\n    def print_chapter(self, num, title, fname):\n        self.add_page()\n        self.chapter_title(num, title)\n        self.chapter_body(fname)\n\n\npdf = PDF()\npdf.set_title(\"20000 Leagues Under the Seas\")\npdf.set_author(\"Jules Verne\")\npdf.print_chapter(1, \"A RUNAWAY REEF\", \"20k_c1.txt\")\npdf.print_chapter(2, \"THE PROS AND CONS\", \"20k_c1.txt\")\npdf.output(\"tuto4.pdf\")",
      "language": "python"
    },
    {
      "code": "import csv\nfrom fpdf import FPDF\nfrom fpdf.fonts import FontFace\nfrom fpdf.enums import TableCellFillMode\n\nwith open(\"countries.txt\", encoding=\"utf8\") as csv_file:\n    data = list(csv.reader(csv_file, delimiter=\",\"))\n\npdf = FPDF()\npdf.set_font(\"helvetica\", size=14)\n\n# Basic table:\npdf.add_page()\nwith pdf.table() as table:\n    for data_row in data:\n        row = table.row()\n        for datum in data_row:\n            row.cell(datum)\n\n# Styled table:\npdf.add_page()\npdf.set_draw_color(255, 0, 0)\npdf.set_line_width(0.3)\nheadings_style = FontFace(emphasis=\"BOLD\", color=255, fill_color=(255, 100, 0))\nwith pdf.table(\n    borders_layout=\"NO_HORIZONTAL_LINES\",\n    cell_fill_color=(224, 235, 255),\n    cell_fill_mode=TableCellFillMode.ROWS,\n    col_widths=(42, 39, 35, 42),\n    headings_style=headings_style,\n    line_height=6,\n    text_align=(\"LEFT\", \"CENTER\", \"RIGHT\", \"RIGHT\"),\n    width=160,\n) as table:\n    for data_row in data:\n        row = table.row()\n        for datum in data_row:\n            row.cell(datum)\n\npdf.output(\"tuto5.pdf\")",
      "language": "swift"
    },
    {
      "code": "from fpdf import FPDF\n\npdf = FPDF()\n\n# First page:\npdf.add_page()\npdf.set_font(\"helvetica\", size=20)\npdf.write(5, \"To find out what's new in self tutorial, click \")\npdf.set_font(style=\"U\")\nlink = pdf.add_link(page=2)\npdf.write(5, \"here\", link)\npdf.set_font()\n\n# Second page:\npdf.add_page()\npdf.image(\n    \"../docs/fpdf2-logo.png\", 10, 10, 50, 0, \"\", \"https://py-pdf.github.io/fpdf2/\"\n)\npdf.set_left_margin(60)\npdf.set_font_size(18)\npdf.write_html(\n    \"\"\"You can print text mixing different styles using HTML tags: <b>bold</b>, <i>italic</i>,\n<u>underlined</u>, or <b><i><u>all at once</u></i></b>!\n<br><br>You can also insert links on text, such as <a href=\"https://py-pdf.github.io/fpdf2/\">https://py-pdf.github.io/fpdf2/</a>,\nor on an image: the logo is clickable!\"\"\"\n)\npdf.output(\"tuto6.pdf\")",
      "language": "swift"
    }
  ],
  "patterns": [],
  "links": [
    "https://py-pdf.github.io/fpdf2/Tutorial-zh.html",
    "https://py-pdf.github.io/fpdf2/index.html",
    "https://py-pdf.github.io/fpdf2/notebook.html",
    "https://py-pdf.github.io/fpdf2/Tutorial.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-bn.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-de.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-es.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-fr.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-gr.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-he.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-hi.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-id.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-it.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-ja.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-km.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-nl.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-pl.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-pt.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-ru.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-tr.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-sl.html",
    "https://py-pdf.github.io/fpdf2/PageFormatAndOrientation.html",
    "https://py-pdf.github.io/fpdf2/Margins.html",
    "https://py-pdf.github.io/fpdf2/Templates.html",
    "https://py-pdf.github.io/fpdf2/TextRegion.html",
    "https://py-pdf.github.io/fpdf2/TextColumns.html",
    "https://py-pdf.github.io/fpdf2/Tables.html",
    "https://py-pdf.github.io/fpdf2/Text.html",
    "https://py-pdf.github.io/fpdf2/LineBreaks.html",
    "https://py-pdf.github.io/fpdf2/PageBreaks.html",
    "https://py-pdf.github.io/fpdf2/TextStyling.html",
    "https://py-pdf.github.io/fpdf2/Unicode.html",
    "https://py-pdf.github.io/fpdf2/TextShaping.html",
    "https://py-pdf.github.io/fpdf2/EmojisSymbolsDingbats.html",
    "https://py-pdf.github.io/fpdf2/HTML.html",
    "https://py-pdf.github.io/fpdf2/Images.html",
    "https://py-pdf.github.io/fpdf2/Shapes.html",
    "https://py-pdf.github.io/fpdf2/Transformations.html",
    "https://py-pdf.github.io/fpdf2/Transparency.html",
    "https://py-pdf.github.io/fpdf2/Patterns.html",
    "https://py-pdf.github.io/fpdf2/Barcodes.html",
    "https://py-pdf.github.io/fpdf2/Drawing.html",
    "https://py-pdf.github.io/fpdf2/SVG.html",
    "https://py-pdf.github.io/fpdf2/Maths.html",
    "https://py-pdf.github.io/fpdf2/Links.html",
    "https://py-pdf.github.io/fpdf2/Metadata.html",
    "https://py-pdf.github.io/fpdf2/Annotations.html",
    "https://py-pdf.github.io/fpdf2/Presentations.html",
    "https://py-pdf.github.io/fpdf2/DocumentOutlineAndTableOfContents.html",
    "https://py-pdf.github.io/fpdf2/PageLabels.html",
    "https://py-pdf.github.io/fpdf2/Encryption.html",
    "https://py-pdf.github.io/fpdf2/Signing.html",
    "https://py-pdf.github.io/fpdf2/FileAttachments.html",
    "https://py-pdf.github.io/fpdf2/pdfa.html",
    "https://py-pdf.github.io/fpdf2/CombineWithPypdf.html",
    "https://py-pdf.github.io/fpdf2/CombineWithMarkdown.html",
    "https://py-pdf.github.io/fpdf2/CombineWithLivereload.html",
    "https://py-pdf.github.io/fpdf2/CombineWithBorb.html",
    "https://py-pdf.github.io/fpdf2/CombineWithPdfrw.html",
    "https://py-pdf.github.io/fpdf2/CombineWithChartingLibs.html",
    "https://py-pdf.github.io/fpdf2/UsageInWebAPI.html",
    "https://py-pdf.github.io/fpdf2/RenderingSpreadsheetsAsPDFTables.html",
    "https://py-pdf.github.io/fpdf2/TemplatingWithJinja.html",
    "https://py-pdf.github.io/fpdf2/CombineWithRoughJS.html",
    "https://py-pdf.github.io/fpdf2/Development.html",
    "https://py-pdf.github.io/fpdf2/Logging.html",
    "https://py-pdf.github.io/fpdf2/Internals.html",
    "https://py-pdf.github.io/fpdf2/fpdf/",
    "https://py-pdf.github.io/fpdf2/History.html",
    "https://py-pdf.github.io/fpdf2/fpdf/fpdf.html",
    "https://py-pdf.github.io/fpdf2/fpdf/enums.html",
    "https://py-pdf.github.io/fpdf2/fpdf2-logo.png"
  ]
}