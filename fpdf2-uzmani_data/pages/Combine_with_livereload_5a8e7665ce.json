{
  "url": "https://py-pdf.github.io/fpdf2/CombineWithLivereload.html",
  "title": "Combine with livereload¶",
  "content": "A nice feature of PDF readers is when they detect changes to the .pdf files open and automatically reload them in the viewer. Adobe Acrobat Reader does not provide this feature but other viewers offer it, like the free & open source Sumatra PDF Reader under Windows.\n\nWhen using such PDF reader, it can be very useful to use a \"watch\" mode, so that every change to the Python code will trigger the regeneration of the PDF file.\n\nThe following script is an example of using livereload with fpdf2 to do that. Launched without parameters, this script only generates a PDF document. But when launched with --watch as argument, it will detect changes to the Python script itself, and then reload itself with xreload, and finally regenerate the PDF document.\n\nNote that the module reloading mechanism provided by xreload has several limitations, cf. xreload.py.",
  "headings": [
    {
      "level": "h1",
      "text": "Combine with livereload¶",
      "id": "combine-with-livereload"
    }
  ],
  "code_samples": [
    {
      "code": "#!/usr/bin/env python3\n# Script Dependencies:\n#    fpdf2\n#    livereload\n#    xreload\nimport asyncio, logging, sys\nfrom traceback import print_exc\n\nfrom fpdf import FPDF\nfrom livereload.watcher import get_watcher_class\nfrom xreload import xreload\n\nOUT_FILEPATH = \"fpdf2-demo.pdf\"\n\n\ndef build_pdf():\n    pdf = FPDF()\n    pdf.set_font(\"Helvetica\", size=16)\n    pdf.add_page()\n    pdf.y += 50\n    pdf.multi_cell(\n        h=10,\n        w=0,\n        align=\"C\",\n        text=\"\"\"Hello fpdf2 user!\nLaunch this script with --watch\nand then try to modify this text while the script is running\"\"\",\n    )\n    pdf.output(OUT_FILEPATH)\n    print(f\"{OUT_FILEPATH} has been rebuilt\")\n\n\nasync def start_watch_and_rebuild():\n    logging.basicConfig(\n        format=\"%(asctime)s %(name)s [%(levelname)s] %(message)s\",\n        datefmt=\"%H:%M:%S\",\n        level=logging.INFO,\n    )\n    logging.getLogger(\"livereload\").setLevel(logging.INFO)\n    watcher = get_watcher_class()()\n    watcher.watch(__file__, build_pdf)\n    print(\"Watcher started...\")\n    await watch_periodically(watcher)\n\n\nasync def watch_periodically(watcher, delay_secs=0.8):\n    try:\n        watcher.examine()\n    except Exception:\n        print_exc()\n    await asyncio.sleep(delay_secs)\n    xreload(sys.modules[__name__], new_annotations={\"XRELOADED\": True})\n    await asyncio.create_task(watch_periodically(watcher))\n\n\n# This conditional ensure that the code below\n# does not get executed when calling xreload on this module:\nif not __annotations__.get(\"XRELOADED\"):\n    build_pdf()\n    # The --watch mode is very handy when using a PDF reader\n    # that performs hot-reloading, like Sumatra PDF Reader:\n    if \"--watch\" in sys.argv:\n        asyncio.run(start_watch_and_rebuild())",
      "language": "python"
    }
  ],
  "patterns": [],
  "links": [
    "https://py-pdf.github.io/fpdf2/CombineWithLivereload.html",
    "https://py-pdf.github.io/fpdf2/index.html",
    "https://py-pdf.github.io/fpdf2/notebook.html",
    "https://py-pdf.github.io/fpdf2/Tutorial.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-bn.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-de.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-es.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-fr.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-gr.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-he.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-hi.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-id.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-it.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-ja.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-km.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-nl.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-pl.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-pt.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-ru.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-tr.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-zh.html",
    "https://py-pdf.github.io/fpdf2/Tutorial-sl.html",
    "https://py-pdf.github.io/fpdf2/PageFormatAndOrientation.html",
    "https://py-pdf.github.io/fpdf2/Margins.html",
    "https://py-pdf.github.io/fpdf2/Templates.html",
    "https://py-pdf.github.io/fpdf2/TextRegion.html",
    "https://py-pdf.github.io/fpdf2/TextColumns.html",
    "https://py-pdf.github.io/fpdf2/Tables.html",
    "https://py-pdf.github.io/fpdf2/Text.html",
    "https://py-pdf.github.io/fpdf2/LineBreaks.html",
    "https://py-pdf.github.io/fpdf2/PageBreaks.html",
    "https://py-pdf.github.io/fpdf2/TextStyling.html",
    "https://py-pdf.github.io/fpdf2/Unicode.html",
    "https://py-pdf.github.io/fpdf2/TextShaping.html",
    "https://py-pdf.github.io/fpdf2/EmojisSymbolsDingbats.html",
    "https://py-pdf.github.io/fpdf2/HTML.html",
    "https://py-pdf.github.io/fpdf2/Images.html",
    "https://py-pdf.github.io/fpdf2/Shapes.html",
    "https://py-pdf.github.io/fpdf2/Transformations.html",
    "https://py-pdf.github.io/fpdf2/Transparency.html",
    "https://py-pdf.github.io/fpdf2/Patterns.html",
    "https://py-pdf.github.io/fpdf2/Barcodes.html",
    "https://py-pdf.github.io/fpdf2/Drawing.html",
    "https://py-pdf.github.io/fpdf2/SVG.html",
    "https://py-pdf.github.io/fpdf2/Maths.html",
    "https://py-pdf.github.io/fpdf2/Links.html",
    "https://py-pdf.github.io/fpdf2/Metadata.html",
    "https://py-pdf.github.io/fpdf2/Annotations.html",
    "https://py-pdf.github.io/fpdf2/Presentations.html",
    "https://py-pdf.github.io/fpdf2/DocumentOutlineAndTableOfContents.html",
    "https://py-pdf.github.io/fpdf2/PageLabels.html",
    "https://py-pdf.github.io/fpdf2/Encryption.html",
    "https://py-pdf.github.io/fpdf2/Signing.html",
    "https://py-pdf.github.io/fpdf2/FileAttachments.html",
    "https://py-pdf.github.io/fpdf2/pdfa.html",
    "https://py-pdf.github.io/fpdf2/CombineWithPypdf.html",
    "https://py-pdf.github.io/fpdf2/CombineWithMarkdown.html",
    "https://py-pdf.github.io/fpdf2/CombineWithBorb.html",
    "https://py-pdf.github.io/fpdf2/CombineWithPdfrw.html",
    "https://py-pdf.github.io/fpdf2/CombineWithChartingLibs.html",
    "https://py-pdf.github.io/fpdf2/UsageInWebAPI.html",
    "https://py-pdf.github.io/fpdf2/RenderingSpreadsheetsAsPDFTables.html",
    "https://py-pdf.github.io/fpdf2/TemplatingWithJinja.html",
    "https://py-pdf.github.io/fpdf2/CombineWithRoughJS.html",
    "https://py-pdf.github.io/fpdf2/Development.html",
    "https://py-pdf.github.io/fpdf2/Logging.html",
    "https://py-pdf.github.io/fpdf2/Internals.html",
    "https://py-pdf.github.io/fpdf2/fpdf/",
    "https://py-pdf.github.io/fpdf2/History.html"
  ]
}